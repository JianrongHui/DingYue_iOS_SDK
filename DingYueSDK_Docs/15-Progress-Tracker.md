# å¼€å‘è¿›åº¦è¿½è¸ª

> ç”¨é€”ï¼šè·¨ AI/è·¨äººå‘˜äº¤æ¥æ—¶å¿«é€Ÿäº†è§£"å·²å®Œæˆ/è¿›è¡Œä¸­/å¾…åŠ"ã€‚
> æ›´æ–°æ–¹å¼ï¼šæ¯æ¬¡åˆå¹¶æˆ–é‡Œç¨‹ç¢‘å˜æ›´åæ›´æ–°æœ¬æ–‡ä»¶ï¼ŒåŠ¡å¿…é™„å¸¦æ—¥æœŸã€‚
> æœ€åæ›´æ–°ï¼š2025-01-XX

---

## æ€»ä½“è¿›åº¦æ¦‚è§ˆ

| é‡Œç¨‹ç¢‘ | æè¿° | è¿›åº¦ | Owner | çŠ¶æ€ |
|--------|------|------|-------|------|
| M1 | åå°åŸºç¡€èƒ½åŠ›ï¼ˆé…ç½®/äº‹ä»¶/åŒ…ç®¡ç†ï¼‰ | 30% | Backend | ğŸŸ¡ è¿›è¡Œä¸­ |
| M2 | ç®¡ç†åå°ï¼ˆWeb Adminï¼‰ | 20% | Web | ğŸŸ¡ è¿›è¡Œä¸­ |
| M3 | SDK æ”¹é€ ï¼ˆiOSï¼‰ | 70% | iOS | ğŸŸ¡ è¿›è¡Œä¸­ |
| M4 | æ•°æ®ä¸åˆ†æï¼ˆGA/Firebase/æ•°ä»“ï¼‰ | 0% | Data | â¬œ å¾…å¼€å§‹ |

---

## M1 åå°åŸºç¡€èƒ½åŠ› (30%)

### å·²å®Œæˆ
- [x] æœåŠ¡å™¨éª¨æ¶ï¼ˆExpress + TypeScriptï¼‰
- [x] `/healthz` å¥åº·æ£€æŸ¥è·¯ç”±
- [x] `request_id` ä¸­é—´ä»¶
- [x] `error_handler` ä¸­é—´ä»¶
- [x] `/v1/sdk/config` å ä½å®ç°
- [x] `/v1/sdk/events` å ä½å®ç°
- [x] `/v1/admin/packages/presign` å ä½å®ç°
- [x] `/v1/admin/packages/commit` å ä½å®ç°
- [x] è§„åˆ™å¼•æ“åº“ï¼ˆDSL è§£æä¸å‘½ä¸­åˆ¤æ–­ï¼‰
- [x] å®éªŒåˆ†æµç®—æ³•ï¼ˆhash + bucketï¼‰

### è¿›è¡Œä¸­
- [ ] HMAC-SHA256 é‰´æƒä¸­é—´ä»¶ `@Backend`
  - ä¾èµ–ï¼šæ— 
  - è§„èŒƒï¼š02-Backend-APIs.md â†’ é‰´æƒç« èŠ‚

### å¾…åŠï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
| ä»»åŠ¡ | Owner | ä¾èµ– | å¯¹åº”è§„èŒƒ |
|------|-------|------|----------|
| äº‹ä»¶æŒä¹…åŒ–ï¼ˆæ›¿æ¢å†…å­˜ç¼“å†²ï¼Œè½åº“ events è¡¨ï¼‰ | Backend | PostgreSQL è¡¨ç»“æ„ | 03-Database-Schema |
| é…ç½®æ¥å£æ¥å…¥è§„åˆ™å¼•æ“ä¸å®éªŒåˆ†æµ | Backend | è§„åˆ™å¼•æ“åº“ | 06-Targeting-Experiments |
| åŒ…ç®¡ç†ï¼šmanifest æ ¡éªŒ + checksum è®¡ç®— | Backend | æ—  | 08-H5-Package-Spec |
| åŒ…ç®¡ç†ï¼šCDN URL ç”Ÿæˆ | Backend | å¯¹è±¡å­˜å‚¨é…ç½® | 02-Backend-APIs |
| PostgreSQL è¡¨ç»“æ„è¿ç§»è„šæœ¬ | Backend | æ—  | 03-Database-Schema |

### éªŒæ”¶æ¡ä»¶
- [ ] `/v1/sdk/config` è¿”å›æœ‰æ•ˆ placement/variant
- [ ] `/v1/sdk/events` å¯æ‰¹é‡å…¥åº“
- [ ] åŒ…ä¸Šä¼ åå¯ç”Ÿæˆ CDN URL ä¸ checksum

---

## M2 ç®¡ç†åå° (20%)

### å·²å®Œæˆ
- [x] web-admin éª¨æ¶ï¼ˆReact + Vite + TypeScriptï¼‰
- [x] é¡µé¢è·¯ç”±é…ç½®
- [x] é™æ€ mock æ•°æ®

### å¾…åŠ
| ä»»åŠ¡ | Owner | ä¾èµ– | å¯¹åº”è§„èŒƒ |
|------|-------|------|----------|
| App ç®¡ç†é¡µé¢ï¼ˆåˆ—è¡¨/åˆ›å»º/ç¦ç”¨ï¼‰ | Web | M1 Admin API | 07-Admin-Console |
| Placement ç®¡ç†é¡µé¢ | Web | M1 Admin API | 07-Admin-Console |
| Variant ç®¡ç†é¡µé¢ | Web | M1 Admin API | 07-Admin-Console |
| è§„åˆ™å¯è§†åŒ–æ„å»ºå™¨ | Web | M1 è§„åˆ™å¼•æ“ | 06-Targeting-Experiments |
| åŒ…ä¸Šä¼ ä¸ç‰ˆæœ¬ç®¡ç† | Web | M1 åŒ…ç®¡ç† API | 07-Admin-Console |
| å®éªŒç®¡ç†é¡µé¢ | Web | M1 å®éªŒ API | 07-Admin-Console |
| äº‹ä»¶æŸ¥è¯¢é¡µé¢ | Web | M1 äº‹ä»¶ API | 07-Admin-Console |

### éªŒæ”¶æ¡ä»¶
- [ ] å¯å®Œæˆç«¯åˆ°ç«¯é…ç½®æŠ•æ”¾
- [ ] å¯å›æ»š H5 åŒ…ç‰ˆæœ¬
- [ ] è§„åˆ™é¢„è§ˆä¸å‘½ä¸­æµ‹è¯•å¯ç”¨

---

## M3 SDK æ”¹é€  (70%)

### å·²å®Œæˆ
- [x] RevenueCat PurchaseProvider é€‚é…
- [x] äº‹ä»¶é˜Ÿåˆ—ä¸æ‰¹é‡ä¸ŠæŠ¥
- [x] ConfigProvider é…ç½®æ‹‰å–
- [x] H5 åŒ…ç®¡ç†ï¼ˆä¸‹è½½/è§£å‹/ç¼“å­˜ï¼‰
- [x] Example Demo æ”¹é€ 
- [x] H5Samples/Paywall ç¤ºä¾‹åŒ…
- [x] H5Samples/Guide ç¤ºä¾‹åŒ…
- [x] vip_*/guide_* Bridge å…¼å®¹

### è¿›è¡Œä¸­
- [ ] è”è°ƒéªŒè¯ï¼ˆä¸åç«¯çœŸå®æ¥å£è”è°ƒï¼‰ `@iOS`
  - ä¾èµ–ï¼šM1 é…ç½®/äº‹ä»¶æ¥å£å®Œæˆ

### å¾…åŠ
| ä»»åŠ¡ | Owner | ä¾èµ– | å¯¹åº”è§„èŒƒ |
|------|-------|------|----------|
| HMAC ç­¾åå®ç°ï¼ˆiOS ä¾§ï¼‰ | iOS | M1 é‰´æƒè§„èŒƒ | 02-Backend-APIs |
| manifest.json entry_path å¤šå±‚ç›®å½•æ”¯æŒéªŒè¯ | iOS | æ—  | 08-H5-Package-Spec |
| checksum æ ¡éªŒå¤±è´¥å›é€€é€»è¾‘ | iOS | æ—  | 08-H5-Package-Spec |
| vip_page_options/guide_page_options è‡ªåŠ¨å…³é—­æ§åˆ¶ | iOS | æ—  | 08-H5-Package-Spec |
| å®Œæ•´äº‹ä»¶å­—æ®µè¡¥é½ | iOS | æ—  | 11-SDK-Event-Spec |

### éªŒæ”¶æ¡ä»¶
- [ ] Guide/Paywall å¯æ­£ç¡®å±•ç¤º
- [ ] è´­ä¹°æˆåŠŸèµ° RevenueCat å¹¶ä¸ŠæŠ¥äº‹ä»¶
- [ ] äº‹ä»¶å®Œæ•´ä¸ŠæŠ¥ï¼ˆå« customer_info_summaryï¼‰
- [ ] è‡ªåŠ¨å…³é—­æ§åˆ¶ç”Ÿæ•ˆ

---

## M4 æ•°æ®ä¸åˆ†æ (0%)

### å¾…åŠ
| ä»»åŠ¡ | Owner | ä¾èµ– | å¯¹åº”è§„èŒƒ |
|------|-------|------|----------|
| GA4 äº‹ä»¶è½¬å‘ | Data | M1 äº‹ä»¶æ¥å£ | 05-Analytics-Mapping |
| Firebase äº‹ä»¶è½¬å‘ | Data | M1 äº‹ä»¶æ¥å£ | 05-Analytics-Mapping |
| analytics_sinks é…ç½®ç®¡ç† | Backend | M1 è¡¨ç»“æ„ | 03-Database-Schema |
| æ•°ä»“ fact_events è¡¨ä¸ ETL | Data | M1 äº‹ä»¶æ¥å£ | 09-Data-Warehouse |
| ç»Ÿè®¡ SQL æ¨¡æ¿éªŒè¯ | Data | æ•°ä»“è¡¨ | 10-Analytics-SQL |
| è½¬åŒ–ç‡æŠ¥è¡¨ | Data | æ•°ä»“è¡¨ | 10-Analytics-SQL |
| å®éªŒå¯¹æ¯”åˆ†æ | Data | æ•°ä»“è¡¨ | 10-Analytics-SQL |

### éªŒæ”¶æ¡ä»¶
- [ ] GA/Firebase è½¬å‘æ•°æ®å‡†ç¡®
- [ ] æ ¸å¿ƒæ¼æ–—å¯æŸ¥ï¼ˆPaywall Enter â†’ Purchase Successï¼‰
- [ ] å®éªŒå¯¹æ¯”å¯ç”¨

---

## é£é™©ä¸é˜»å¡é¡¹

| é£é™©/é˜»å¡ | ä¸¥é‡ç¨‹åº¦ | çŠ¶æ€ | è´Ÿè´£äºº | åº”å¯¹æªæ–½ |
|-----------|----------|------|--------|----------|
| RevenueCat Offering ç¼ºå¤± | ğŸŸ¡ ä¸­ | ç›‘æ§ä¸­ | iOS | fallback to current offering + å‘Šè­¦ |
| H5 åŒ…ä½“ç§¯è¿‡å¤§å½±å“åŠ è½½ | ğŸŸ¡ ä¸­ | ç›‘æ§ä¸­ | Web | é™åˆ¶ <=10MBï¼Œå•èµ„æº <=2MB |
| CDN éƒ¨ç½²æ–¹æ¡ˆæœªç¡®å®š | ğŸ”´ é«˜ | å¾…å®š | Backend | éœ€ç¡®è®¤å¯¹è±¡å­˜å‚¨ä¸ CDN é€‰å‹ |
| äº‹ä»¶ä¸¢å¤±é£é™© | ğŸŸ¡ ä¸­ | å·²ç¼“è§£ | iOS | æœ¬åœ°æŒä¹…é˜Ÿåˆ— + é‡è¯•æœºåˆ¶ |

---

## ä»»åŠ¡ä¾èµ–å…³ç³»

```
M1 åå°åŸºç¡€èƒ½åŠ›
â”œâ”€â”€ HMAC é‰´æƒä¸­é—´ä»¶
â”‚   â””â”€â”€ SDK HMAC ç­¾åå®ç° (iOS)
â”œâ”€â”€ äº‹ä»¶æŒä¹…åŒ–
â”‚   â””â”€â”€ GA/Firebase è½¬å‘ (M4)
â”‚   â””â”€â”€ æ•°ä»“ ETL (M4)
â”œâ”€â”€ é…ç½®æ¥å£æ¥å…¥è§„åˆ™å¼•æ“
â”‚   â””â”€â”€ SDK è”è°ƒéªŒè¯ (iOS)
â”œâ”€â”€ åŒ…ç®¡ç†å®Œå–„
â”‚   â””â”€â”€ ç®¡ç†åå°åŒ…ä¸Šä¼  (M2)

M2 ç®¡ç†åå°
â”œâ”€â”€ ä¾èµ– M1 æ‰€æœ‰ Admin API

M3 SDK æ”¹é€ 
â”œâ”€â”€ è”è°ƒéªŒè¯ä¾èµ– M1 é…ç½®/äº‹ä»¶æ¥å£

M4 æ•°æ®ä¸åˆ†æ
â”œâ”€â”€ ä¾èµ– M1 äº‹ä»¶æ¥å£ä¸è¡¨ç»“æ„
```

---

## æ›´æ–°è®°å½•

| æ—¥æœŸ | å˜æ›´å†…å®¹ | æ“ä½œäºº |
|------|----------|--------|
| 2025-01-XX | æœåŠ¡å™¨éª¨æ¶ä¸åŸºç¡€ä¸­é—´ä»¶åˆå¹¶åˆ° main | - |
| 2025-01-XX | è§„åˆ™å¼•æ“åº“åˆå¹¶åˆ° main | - |
| 2025-01-XX | è·¯ç”±åœ¨ server/src/app.ts æ³¨å†Œ | - |
| 2025-01-XX | web-admin éª¨æ¶åˆå¹¶åˆ° main | - |
| 2025-01-XX | SDK è´­ä¹°é€‚é…ä¸äº‹ä»¶ä¸ŠæŠ¥åˆå¹¶åˆ° main | - |
| 2025-01-XX | SDK é…ç½®æ‹‰å–ä¸ H5 åŒ…ç®¡ç†åˆå¹¶åˆ° main | - |
| 2025-01-XX | Example ä¸ H5Samples åˆå¹¶åˆ° main | - |
| 2025-01-XX | é‡æ„è¿›åº¦è¿½è¸ªæ–‡æ¡£æ ¼å¼ | AI |

---

## äº¤æ¥ç»™æ–°æ‰§è¡Œè€…çš„å¿…è¯»

æŒ‰ä»¥ä¸‹é¡ºåºé˜…è¯»ï¼š

1. **æ€»è§ˆä¸æ¶æ„**ï¼š`01-Solution-Overview.md`
2. **æ¥å£è§„èŒƒ**ï¼š`02-Backend-APIs.md`
3. **äº‹ä»¶å­—å…¸**ï¼š`04-Events-Dictionary.md`
4. **H5 è§„èŒƒ**ï¼š`08-H5-Package-Spec.md`
5. **OpenAPI**ï¼š`12-OpenAPI-Full.yaml`
6. **æ‰§è¡Œæ–¹æ¡ˆ**ï¼š`14-Development-Execution-Plan.md`

### å¿«é€Ÿæ£€æŸ¥æ¸…å•
- [ ] ç¡®è®¤ JSON å­—æ®µä½¿ç”¨ snake_case
- [ ] ç¡®è®¤ HMAC ç­¾åè§„åˆ™ï¼ˆMETHOD\nPATH\nTIMESTAMP\nNONCE\nSHA256(body)ï¼‰
- [ ] ç¡®è®¤ H5 åŒ…å¿…é¡»åŒ…å« manifest.json
- [ ] ç¡®è®¤ Bridge å‘½åï¼ˆvip_*/guide_*ï¼‰
- [ ] ç¡®è®¤äº‹ä»¶å¿…å¡«å­—æ®µï¼ˆè§ 11-SDK-Event-Spec.mdï¼‰
